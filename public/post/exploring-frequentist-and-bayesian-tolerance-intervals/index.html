<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.56.1" />

  <title>Exploring Frequentist and Bayesian Tolerance Intervals &middot; [R]eliability</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">Riley King</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/tw0handt0uch1" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/riley-king-9594247" rel="me" target="_blank"><i class="fab fa-linkedin"></i></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/tw0handt0uch" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

 <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.r-bloggers.com/"><i class="fa fa-rss fa-fw"></i>R-Bloggers</a>
    </li>

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Exploring Frequentist and Bayesian Tolerance Intervals</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 Jun 2021</time>
  </div>

  

  
  
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/r">R</a>
    
  </div>
  
  

</div>

  

<p>Tolerance intervals are used to specify coverage of a population of data.  In the frequentist framework, the width of the interval is dependent on the desired coverage proportion and the specified confidence level.  They are widely used in the medical device industry because they can be compared directly vs. product specifications, allowing the engineer to make a judgment about what percentage of the parts would meet the spec taking into account sampling uncertainty.</p>

<p>In this post I wanted to dive a bit deeper into the frequentist version of tolerance intervals to verify that they provide the correct coverage in a straight-forward use case.  Then I will explore a Bayesian version which uses the posterior draws from a fitted model to calculate the Bayesian analogue of a tolerance interval.</p>

<h1 id="libraries">Libraries</h1>

<pre><code class="language-r">library(tidyverse)
library(here)
library(brms)
library(broom)
library(tidybayes)
library(tolerance)
library(wesanderson)
library(patchwork)
library(gt)
</code></pre>

<p>As with any frequentist simulation looking at coverage of a p-value, we can start with the population parameters known.  From there we simulate many draws from that population and calculate the desired statistic (in this case the tolerance interval limits).  By comparing each calculated tolerance interval to the true population coverage, we can determine the fraction of simulations to do not meet the specified coverage.  If that number, as a fraction of the total number of sims, is less than or equal to the p-value, then the tolerance interval procedure is working as intended and provided the specified coverage, on average, over many simulated experiments.</p>

<p>This block sets up the parameters and identifies the specified quantiles of the true population.</p>

<h1 id="simulated-experiments">Simulated Experiments</h1>

<h2 id="true-population-parameters">True Population Parameters</h2>

<pre><code class="language-r">set.seed(9989)

n_sims &lt;- 10000
true_population_mean &lt;- 40
true_population_sd &lt;- 4
alpha = 0.1
p = .95

upper_97.5 &lt;- qnorm(p = .975, mean = true_population_mean, sd = true_population_sd)
lower_02.5 &lt;- qnorm(p = .025, mean = true_population_mean, sd = true_population_sd)
</code></pre>

<p>Now run the simulation, replicating many &ldquo;experiments&rdquo; of n=15, calculating a 90% confidence, 2-sided tolerance interval for 95% of the population each time.</p>

<h2 id="run-the-simulation">Run the Simulation</h2>

<pre><code class="language-r">sim_summary_tbl &lt;- tibble(sim_id = seq(from = 1, to = n_sims, by = 1)) %&gt;%
  rowwise() %&gt;%
  mutate(
    test_sample_size = 15,
    sim_test_data = list(rnorm(n = test_sample_size, mean = true_population_mean, sd = true_population_sd))
  ) %&gt;%
  summarize(
    sim_id = sim_id,
#   sim_test_data = sim_test_data,
    norm_tol = list(normtol.int(sim_test_data, alpha = alpha, P = p, side = 2)),
    sample_sd = sd(sim_test_data)
  ) %&gt;%
  unnest(norm_tol) %&gt;%
  rename(
    lower_bound_ltl = &quot;2-sided.lower&quot;,
    upper_bound_utl = &quot;2-sided.upper&quot;,
    sample_mean = x.bar,
    p = P
  ) %&gt;%
  ungroup() %&gt;%
  select(sim_id, alpha, p, sample_mean, sample_sd, everything()) %&gt;%
  mutate(
    true_lower_2.5 = lower_02.5,
    true_upper_97.5 = upper_97.5
  )

sim_summary_tbl %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="moscublyzf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#moscublyzf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#moscublyzf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#moscublyzf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#moscublyzf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#moscublyzf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#moscublyzf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#moscublyzf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#moscublyzf .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#moscublyzf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#moscublyzf .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#moscublyzf .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#moscublyzf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#moscublyzf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#moscublyzf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#moscublyzf .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#moscublyzf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#moscublyzf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#moscublyzf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#moscublyzf .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#moscublyzf .gt_left {
  text-align: left;
}</p>

<p>#moscublyzf .gt_center {
  text-align: center;
}</p>

<p>#moscublyzf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#moscublyzf .gt_font_normal {
  font-weight: normal;
}</p>

<p>#moscublyzf .gt_font_bold {
  font-weight: bold;
}</p>

<p>#moscublyzf .gt_font_italic {
  font-style: italic;
}</p>

<p>#moscublyzf .gt_super {
  font-size: 65%;
}</p>

<p>#moscublyzf .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sim_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">alpha</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">p</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sample_mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sample_sd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">lower_bound_ltl</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">upper_bound_utl</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">true_lower_2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">true_upper_97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">0.95</td>
<td class="gt_row gt_right">36.19320</td>
<td class="gt_row gt_right">3.243531</td>
<td class="gt_row gt_right">27.35493</td>
<td class="gt_row gt_right">45.03147</td>
<td class="gt_row gt_right">32.16014</td>
<td class="gt_row gt_right">47.83986</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">0.95</td>
<td class="gt_row gt_right">40.56155</td>
<td class="gt_row gt_right">3.766514</td>
<td class="gt_row gt_right">30.29821</td>
<td class="gt_row gt_right">50.82489</td>
<td class="gt_row gt_right">32.16014</td>
<td class="gt_row gt_right">47.83986</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">0.95</td>
<td class="gt_row gt_right">40.23154</td>
<td class="gt_row gt_right">4.268292</td>
<td class="gt_row gt_right">28.60091</td>
<td class="gt_row gt_right">51.86217</td>
<td class="gt_row gt_right">32.16014</td>
<td class="gt_row gt_right">47.83986</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">0.95</td>
<td class="gt_row gt_right">40.24057</td>
<td class="gt_row gt_right">4.175918</td>
<td class="gt_row gt_right">28.86165</td>
<td class="gt_row gt_right">51.61949</td>
<td class="gt_row gt_right">32.16014</td>
<td class="gt_row gt_right">47.83986</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">0.95</td>
<td class="gt_row gt_right">40.41020</td>
<td class="gt_row gt_right">3.880094</td>
<td class="gt_row gt_right">29.83737</td>
<td class="gt_row gt_right">50.98303</td>
<td class="gt_row gt_right">32.16014</td>
<td class="gt_row gt_right">47.83986</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..9999</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">10000</td>
<td class="gt_row gt_right">10000</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">0.95</td>
<td class="gt_row gt_right">38.69646</td>
<td class="gt_row gt_right">4.780010</td>
<td class="gt_row gt_right">25.67145</td>
<td class="gt_row gt_right">51.72147</td>
<td class="gt_row gt_right">32.16014</td>
<td class="gt_row gt_right">47.83986</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve--></p>

<h2 id="visualize">Visualize</h2>

<p>Plot the resulting upper and lower bounds of the <sup>95</sup>&frasl;<sub>90</sub> tolerance interval. The red lines are the true population quantiles.</p>

<pre><code class="language-r">sim_summary_tbl %&gt;% 
  pivot_longer(cols = everything(), names_to = &quot;param&quot;, values_to = &quot;value&quot;) %&gt;%
  filter(param == &quot;lower_bound_ltl&quot; | param == &quot;upper_bound_utl&quot;) %&gt;%
  mutate(param = as_factor(param)) %&gt;%
  ggplot(aes(x = value, y = param)) +
  geom_jitter(aes(color = param), width = .1, height = .1, size = .3, alpha = .05) +
  stat_halfeye(aes(fill = param), alpha = .7, position = position_nudge(y = .2)) +
  geom_vline(xintercept = mean(sim_summary_tbl$true_lower_2.5), color = &quot;firebrick&quot;, linetype = 2) +
  geom_vline(xintercept = mean(sim_summary_tbl$true_upper_97.5), color = &quot;firebrick&quot;, linetype = 2) +
  scale_color_manual(values = wes_palette(&quot;Moonrise2&quot;)) +
  scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) +
#  scale_color_manual(values = c(&quot;purple&quot;, &quot;limegreen&quot;)) +
#  scale_fill_manual(values = c(&quot;purple&quot;, &quot;limegreen&quot;)) +
  labs(
      x = &quot;&quot;,
      y = &quot;&quot;,
      title = &quot;Distribution of Calculated Upper and Lower Tolerance Limits&quot;,
      subtitle = &quot;10,000 Simulations of n=15 parts with 2-sided normal Tolerance Intervals&quot;,
      caption = &quot;pink vertical lines represent true population quantiles, .025 and .975&quot;
    ) +
  theme(legend.title = element_blank(),
        legend.position = &quot;bottom&quot;) 
</code></pre>

<p><img src="/post/2021-06-22-exploring-frequentist-and-bayesian-tolerance-intervals_files/figure-html/unnamed-chunk-4-1.png" width="100%" height="500px" />
To see if the tolerance interval procedure is providing the desired coverage, we have to look at each set of lower and upper limits from each simulation.   The code below converts the calculated tolerance bounds from each sim into quantiles of the true population, then calculates the difference to determine the true population coverage of the simulated experiment.  If the coverage is less than intended, a flag of 1 is assigned in the &ldquo;unacceptable_coverage&rdquo; col, else 0.</p>

<h2 id="evaluate-true-coverage-of-each-simulated-experiment">Evaluate True Coverage of Each Simulated Experiment</h2>

<pre><code class="language-r">coverage_summary_tbl &lt;- sim_summary_tbl %&gt;%
  mutate(ltl_coverage_true = map_dbl(lower_bound_ltl, pnorm, true_population_mean, true_population_sd),
         utl_coverage_true = map_dbl(upper_bound_utl, pnorm, true_population_mean, true_population_sd)) %&gt;%
  mutate(total_tl_coverage_true = utl_coverage_true - ltl_coverage_true) %&gt;%
  mutate(unacceptable_coverage = case_when(total_tl_coverage_true &gt;= p ~ 0,
                                         TRUE ~ 1)) %&gt;%
  select(-c(alpha, p, true_lower_2.5, true_upper_97.5)) 

coverage_summary_tbl %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="ixrqpuauby" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#ixrqpuauby .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#ixrqpuauby .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#ixrqpuauby .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#ixrqpuauby .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#ixrqpuauby .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#ixrqpuauby .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#ixrqpuauby .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#ixrqpuauby .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#ixrqpuauby .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#ixrqpuauby .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#ixrqpuauby .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#ixrqpuauby .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#ixrqpuauby .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#ixrqpuauby .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#ixrqpuauby .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#ixrqpuauby .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#ixrqpuauby .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#ixrqpuauby .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#ixrqpuauby .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#ixrqpuauby .gt_left {
  text-align: left;
}</p>

<p>#ixrqpuauby .gt_center {
  text-align: center;
}</p>

<p>#ixrqpuauby .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#ixrqpuauby .gt_font_normal {
  font-weight: normal;
}</p>

<p>#ixrqpuauby .gt_font_bold {
  font-weight: bold;
}</p>

<p>#ixrqpuauby .gt_font_italic {
  font-style: italic;
}</p>

<p>#ixrqpuauby .gt_super {
  font-size: 65%;
}</p>

<p>#ixrqpuauby .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sim_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sample_mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sample_sd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">lower_bound_ltl</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">upper_bound_utl</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ltl_coverage_true</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">utl_coverage_true</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">total_tl_coverage_true</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">unacceptable_coverage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">36.19320</td>
<td class="gt_row gt_right">3.243531</td>
<td class="gt_row gt_right">27.35493</td>
<td class="gt_row gt_right">45.03147</td>
<td class="gt_row gt_right">0.0007854236</td>
<td class="gt_row gt_right">0.8957802</td>
<td class="gt_row gt_right">0.8949948</td>
<td class="gt_row gt_right">1</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">40.56155</td>
<td class="gt_row gt_right">3.766514</td>
<td class="gt_row gt_right">30.29821</td>
<td class="gt_row gt_right">50.82489</td>
<td class="gt_row gt_right">0.0076447723</td>
<td class="gt_row gt_right">0.9965973</td>
<td class="gt_row gt_right">0.9889526</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">40.23154</td>
<td class="gt_row gt_right">4.268292</td>
<td class="gt_row gt_right">28.60091</td>
<td class="gt_row gt_right">51.86217</td>
<td class="gt_row gt_right">0.0021875221</td>
<td class="gt_row gt_right">0.9984893</td>
<td class="gt_row gt_right">0.9963017</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">40.24057</td>
<td class="gt_row gt_right">4.175918</td>
<td class="gt_row gt_right">28.86165</td>
<td class="gt_row gt_right">51.61949</td>
<td class="gt_row gt_right">0.0026797862</td>
<td class="gt_row gt_right">0.9981630</td>
<td class="gt_row gt_right">0.9954832</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">5</td>
<td class="gt_row gt_right">40.41020</td>
<td class="gt_row gt_right">3.880094</td>
<td class="gt_row gt_right">29.83737</td>
<td class="gt_row gt_right">50.98303</td>
<td class="gt_row gt_right">0.0055321969</td>
<td class="gt_row gt_right">0.9969814</td>
<td class="gt_row gt_right">0.9914492</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..9999</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">10000</td>
<td class="gt_row gt_right">10000</td>
<td class="gt_row gt_right">38.69646</td>
<td class="gt_row gt_right">4.780010</td>
<td class="gt_row gt_right">25.67145</td>
<td class="gt_row gt_right">51.72147</td>
<td class="gt_row gt_right">0.0001703976</td>
<td class="gt_row gt_right">0.9983072</td>
<td class="gt_row gt_right">0.9981368</td>
<td class="gt_row gt_right">0</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve--></p>

<h2 id="count-false-positives">Count False Positives</h2>

<p>For the coverage to be correct, the percentage of false positives (simulated experiments that covered less than p% of the true population) should be less than or equal to alpha (10%).  That would mean less than .1(10000) = 1000 cases where the tolerance interval covered less than 95% of the true population.</p>

<pre><code class="language-r">coverage_summary_tbl %&gt;%
  summarize(
    false_positives = sum(unacceptable_coverage),
    false_positive_limit = alpha * n_sims
  ) %&gt;%
  mutate(
    alpha_level = alpha,
    total_trials = n_sims,
    false_positive_rate = false_positives / n_sims,
    &quot;tol_limit_procedure_working?&quot; = case_when(
      false_positives &lt; false_positive_limit ~ &quot;heck_yes&quot;,
      TRUE ~ &quot;boo&quot;
    )) %&gt;%
  select(total_trials, alpha_level, false_positive_limit, everything()) %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="hblnhaayca" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#hblnhaayca .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#hblnhaayca .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#hblnhaayca .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#hblnhaayca .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#hblnhaayca .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#hblnhaayca .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#hblnhaayca .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#hblnhaayca .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#hblnhaayca .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#hblnhaayca .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#hblnhaayca .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#hblnhaayca .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#hblnhaayca .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#hblnhaayca .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#hblnhaayca .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#hblnhaayca .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#hblnhaayca .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#hblnhaayca .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#hblnhaayca .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#hblnhaayca .gt_left {
  text-align: left;
}</p>

<p>#hblnhaayca .gt_center {
  text-align: center;
}</p>

<p>#hblnhaayca .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#hblnhaayca .gt_font_normal {
  font-weight: normal;
}</p>

<p>#hblnhaayca .gt_font_bold {
  font-weight: bold;
}</p>

<p>#hblnhaayca .gt_font_italic {
  font-style: italic;
}</p>

<p>#hblnhaayca .gt_super {
  font-size: 65%;
}</p>

<p>#hblnhaayca .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">total_trials</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">alpha_level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">false_positive_limit</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">false_positives</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">false_positive_rate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">tol_limit_procedure_working?</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">10000</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">1000</td>
<td class="gt_row gt_right">958</td>
<td class="gt_row gt_right">0.0958</td>
<td class="gt_row gt_left">heck_yes</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve--></p>

<p>Because .0958 is less than .1 (10%) we can say that the tolerance interval procedure is capturing the desired population proportion (95%) with an acceptable false positive rate (&lt;= 10%).  Neat!</p>

<p>Now let&rsquo;s look at the Bayesian analogue.</p>

<h1 id="bayesian-2-sided-tolerance-interval">Bayesian 2-sided Tolerance Interval</h1>

<h2 id="load-the-data">Load the Data</h2>

<p>The dataset and example used for this section is adapted from <a href="https://nvlpubs.nist.gov/nistpubs/jres/126/jres.126.004.pdf">this excellent paper on coverage intervals</a>.<sup class="footnote-ref" id="fnref:Stoudt-S-Pintar"><a href="#fn:Stoudt-S-Pintar">1</a></sup> The values represent measurements of mass fraction of iron made by the National Institute of Standards and Technology (NIST).  Units of measurement are percentages, or cg/g.</p>

<pre><code class="language-r">w_tbl &lt;- tibble(w = c(67.43, 66.97, 67.65, 66.84, 67.05, 66.57, 67.16, 68.3,
67.01, 67.07, 67.23, 66.51, 66.46, 67.54, 67.09, 66.77)) %&gt;%
  mutate(w_pct = w/100)
</code></pre>

<p>In preparation for the Bayesian tolerance interval calculations we should run some prior predictive checks. I know Beta(1,1) is a flat prior on mu, but I am not experienced enough with the cauchy to mentally visualize what its parameters mean with respect to the outcome variable.  I adjusted the scale parameter for sigma manually and did this visual check each time until I saw a nice cloud of curves of varying but reasonable widths at scale = .025.  Bonus - it is so satisfying to make the code for these curves using map2 and dplyr in the prep and then ggplot for the vis - incredibly smooth, readable, and efficient.  I remain grateful for these core packages, especially as I start to mess around with other languages.</p>

<h2 id="prior-predictive-simulations">Prior Predictive Simulations</h2>

<pre><code class="language-r">set.seed(2005)

prior_pred_tbl &lt;- tibble(mu = rbeta(300, 1, 1),
       sig = rcauchy(300, 0, 0.025) %&gt;% abs()) %&gt;%
  mutate(row_id = row_number()) %&gt;%
  select(row_id, everything()) %&gt;%
  mutate(plotted_y_data = map2(mu, sig, ~tibble(
    x = seq(0, 1, length.out = 100),
    y = dnorm(x, .x, .y)))) %&gt;%
  unnest() %&gt;%
  mutate(model = &quot;mu ~ beta(1,1), sigma ~ cauchy(0,0.025)&quot;)

prior_pred_tbl %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="spvhicbjem" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#spvhicbjem .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#spvhicbjem .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#spvhicbjem .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#spvhicbjem .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#spvhicbjem .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#spvhicbjem .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#spvhicbjem .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#spvhicbjem .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#spvhicbjem .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#spvhicbjem .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#spvhicbjem .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#spvhicbjem .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#spvhicbjem .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#spvhicbjem .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#spvhicbjem .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#spvhicbjem .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#spvhicbjem .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#spvhicbjem .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#spvhicbjem .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#spvhicbjem .gt_left {
  text-align: left;
}</p>

<p>#spvhicbjem .gt_center {
  text-align: center;
}</p>

<p>#spvhicbjem .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#spvhicbjem .gt_font_normal {
  font-weight: normal;
}</p>

<p>#spvhicbjem .gt_font_bold {
  font-weight: bold;
}</p>

<p>#spvhicbjem .gt_font_italic {
  font-style: italic;
}</p>

<p>#spvhicbjem .gt_super {
  font-size: 65%;
}</p>

<p>#spvhicbjem .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">row_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mu</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sig</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">x</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">model</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.1675134</td>
<td class="gt_row gt_right">2.18178615</td>
<td class="gt_row gt_right">0.00000000</td>
<td class="gt_row gt_right">1.823131e-01</td>
<td class="gt_row gt_left">mu ~ beta(1,1), sigma ~ cauchy(0,0.025)</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.1675134</td>
<td class="gt_row gt_right">2.18178615</td>
<td class="gt_row gt_right">0.01010101</td>
<td class="gt_row gt_right">1.823759e-01</td>
<td class="gt_row gt_left">mu ~ beta(1,1), sigma ~ cauchy(0,0.025)</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.1675134</td>
<td class="gt_row gt_right">2.18178615</td>
<td class="gt_row gt_right">0.02020202</td>
<td class="gt_row gt_right">1.824349e-01</td>
<td class="gt_row gt_left">mu ~ beta(1,1), sigma ~ cauchy(0,0.025)</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.1675134</td>
<td class="gt_row gt_right">2.18178615</td>
<td class="gt_row gt_right">0.03030303</td>
<td class="gt_row gt_right">1.824900e-01</td>
<td class="gt_row gt_left">mu ~ beta(1,1), sigma ~ cauchy(0,0.025)</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">0.1675134</td>
<td class="gt_row gt_right">2.18178615</td>
<td class="gt_row gt_right">0.04040404</td>
<td class="gt_row gt_right">1.825412e-01</td>
<td class="gt_row gt_left">mu ~ beta(1,1), sigma ~ cauchy(0,0.025)</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..29999</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_left" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">30000</td>
<td class="gt_row gt_right">300</td>
<td class="gt_row gt_right">0.5856645</td>
<td class="gt_row gt_right">0.01596839</td>
<td class="gt_row gt_right">1.00000000</td>
<td class="gt_row gt_right">1.589627e-145</td>
<td class="gt_row gt_left">mu ~ beta(1,1), sigma ~ cauchy(0,0.025)</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve--></p>

<pre><code class="language-r">j &lt;- prior_pred_tbl %&gt;%
  ggplot(aes(x = x, y = y, group = row_id)) +
  geom_line(aes(x, y), alpha = .5, color = &quot;#2c3e50&quot;) +
  labs(
    x = &quot;x&quot;,
    y = &quot;dnorm(x)&quot;
  ) +
  ylim(c(0, 10)) +
  theme_minimal() 

k &lt;- j +
  ylim(c(0, 50)) 

(k + j) + plot_annotation(
  title = 'Prior Predictions: n=300 Possible Distibutions According to Priors:',
  subtitle = 'mu ~ Beta(1,1), sigma ~ cauchy(0, .025)',
  caption = &quot;same data, 2 different y-axis scales&quot;)
</code></pre>

<p><img src="/post/2021-06-22-exploring-frequentist-and-bayesian-tolerance-intervals_files/figure-html/unnamed-chunk-9-1.png" width="100%" height="500px" /></p>

<h2 id="fit-the-model-with-brms">Fit the model with brms</h2>

<p>Use the priors that were just identified to fit a model in brms and visualize the output.  The fuzzy caterpillar is not plotted because its very slow with to render with so many iterations. Don&rsquo;t worry - it&rsquo;s fuzzy.</p>

<h3 id="non-informative-priors">Non-Informative Priors</h3>

<pre><code class="language-r"># w_mod &lt;-
#   brm(
#     data = w_tbl, family = gaussian(),
#     w_pct ~ 1,
#    prior = c(
#      prior(beta(1, 1), class = Intercept),
#      prior(cauchy(0, .025), class = sigma)),
#    iter = 400000, warmup = 50000, chains = 4, cores = 2,
#    seed = 10
#  )

#  w_mod %&gt;% write_rds(here::here(&quot;w_mod.rds&quot;))
 w_mod &lt;-  read_rds(here::here(&quot;w_mod.rds&quot;))

w_mod %&gt;% summary()
</code></pre>

<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: w_pct ~ 1 
##    Data: w_tbl (Number of observations: 16) 
## Samples: 4 chains, each with iter = 4e+05; warmup = 50000; thin = 1;
##          total post-warmup samples = 1400000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.67      0.00     0.67     0.67 1.00   858299   757467
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.01      0.00     0.00     0.01 1.00   792388   740061
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).
</code></pre>

<p>Peek at the posterior tbl for mu and sigma.</p>

<pre><code class="language-r">w_post_tbl &lt;-
  posterior_samples(w_mod) %&gt;%
  select(-lp__) %&gt;%
  rename(&quot;mu&quot; = b_Intercept) 

w_post_tbl %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="keeocegnnv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#keeocegnnv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#keeocegnnv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#keeocegnnv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#keeocegnnv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#keeocegnnv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#keeocegnnv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#keeocegnnv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#keeocegnnv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#keeocegnnv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#keeocegnnv .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#keeocegnnv .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#keeocegnnv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#keeocegnnv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#keeocegnnv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#keeocegnnv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#keeocegnnv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#keeocegnnv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#keeocegnnv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#keeocegnnv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#keeocegnnv .gt_left {
  text-align: left;
}</p>

<p>#keeocegnnv .gt_center {
  text-align: center;
}</p>

<p>#keeocegnnv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#keeocegnnv .gt_font_normal {
  font-weight: normal;
}</p>

<p>#keeocegnnv .gt_font_bold {
  font-weight: bold;
}</p>

<p>#keeocegnnv .gt_font_italic {
  font-style: italic;
}</p>

<p>#keeocegnnv .gt_super {
  font-size: 65%;
}</p>

<p>#keeocegnnv .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mu</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sigma</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">0.6704184</td>
<td class="gt_row gt_right">0.004895014</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">0.6685570</td>
<td class="gt_row gt_right">0.005720891</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">0.6708761</td>
<td class="gt_row gt_right">0.003932762</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">0.6713238</td>
<td class="gt_row gt_right">0.004217306</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">0.6689520</td>
<td class="gt_row gt_right">0.005191162</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..1399999</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1400000</td>
<td class="gt_row gt_right">0.6720105</td>
<td class="gt_row gt_right">0.005901202</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve--></p>

<h3 id="calculate-2-sided-bayesian-tolerance-interval-from-the-posterior-non-informative-priors">Calculate 2-Sided Bayesian Tolerance Interval from the Posterior - Non-Informative Priors</h3>

<p>We&rsquo;ll calculate the <sup>95</sup>&frasl;<sub>90</sub> tolerance limit just like before.  The Bayesian analogue involves doing a row-wise calculation for each posterior draw where the equivalent of a tolerance interval is calculated using the standard formula: x +/- ks, where x is mu and s is sigma.  The k factor is taken as the .95 quantile of a unit normal distribution (thus excluding the top and bottom 5% for 90% coverage).  Doing this for every row in the posterior produces a distribution of upper and lower tolerance bounds - 1 observation for each credible set of mu and sigma.  The 5% &ldquo;confidence&rdquo; analogue is done by excluding the 2.5% most extreme values from the low end of the lower bound distribution and the 2.5% most extreme values from the high end of the upper bound distribution.</p>

<pre><code class="language-r">bt_lower &lt;- quantile(w_post_tbl$mu - qnorm(0.95) * w_post_tbl$sigma, 0.025)
bt_upper &lt;-  quantile(w_post_tbl$mu + qnorm(0.95) * w_post_tbl$sigma, 0.975)

bt_tbl &lt;- tibble(lower_coverage_limit = bt_lower * 100 %&gt;% round(4),
       upper_coverage_limit = bt_upper * 100 %&gt;% round(4),
       method = as_factor(&quot;Bayesian&quot;)) 

bt_tbl %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="cpqafktvfr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#cpqafktvfr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#cpqafktvfr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#cpqafktvfr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#cpqafktvfr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#cpqafktvfr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#cpqafktvfr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#cpqafktvfr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#cpqafktvfr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#cpqafktvfr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#cpqafktvfr .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#cpqafktvfr .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#cpqafktvfr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#cpqafktvfr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#cpqafktvfr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#cpqafktvfr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#cpqafktvfr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#cpqafktvfr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#cpqafktvfr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#cpqafktvfr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#cpqafktvfr .gt_left {
  text-align: left;
}</p>

<p>#cpqafktvfr .gt_center {
  text-align: center;
}</p>

<p>#cpqafktvfr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#cpqafktvfr .gt_font_normal {
  font-weight: normal;
}</p>

<p>#cpqafktvfr .gt_font_bold {
  font-weight: bold;
}</p>

<p>#cpqafktvfr .gt_font_italic {
  font-style: italic;
}</p>

<p>#cpqafktvfr .gt_super {
  font-size: 65%;
}</p>

<p>#cpqafktvfr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">lower_coverage_limit</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">upper_coverage_limit</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">method</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">65.75688</td>
<td class="gt_row gt_right">68.44929</td>
<td class="gt_row gt_left">Bayesian</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve--></p>

<p>So the Bayesian version of a tolerance interval for those relatively vague priors is [65.84, 68.37] after back transforming the percentages to cg/g.</p>

<p>The frequentist version for the same data is calculated as follows with the tolerance package (assuming normality of the experimental data):</p>

<h1 id="frequentist-2-sided-tolerance-interval">Frequentist 2-sided Tolerance Interval</h1>

<pre><code class="language-r">fr_tbl &lt;- tidy(normtol.int(w_tbl$w, alpha = .05, P = .9, side = 2, method = &quot;EXACT&quot;)) %&gt;%
  select(column, mean) %&gt;%
  pivot_wider(names_from = &quot;column&quot;,
              values_from = &quot;mean&quot;) %&gt;%
  select('2-sided.lower', '2-sided.upper') %&gt;%
  mutate(method = as_factor(&quot;Frequentist&quot;)) %&gt;%
  rename(lower_coverage_limit = '2-sided.lower',
         upper_coverage_limit = '2-sided.upper') %&gt;%
  select(method, everything())
</code></pre>

<p>Combining and comparing to the Bayesian version:</p>

<pre><code class="language-r">fr_tbl %&gt;% 
  bind_rows(bt_tbl) %&gt;%
  mutate_if(is.numeric, round, digits = 2) %&gt;%
  mutate(priors = c(&quot;non_informative (implied)&quot;, &quot;non-informative&quot;)) %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="blgxhrurex" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#blgxhrurex .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#blgxhrurex .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#blgxhrurex .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#blgxhrurex .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#blgxhrurex .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#blgxhrurex .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#blgxhrurex .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#blgxhrurex .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#blgxhrurex .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#blgxhrurex .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#blgxhrurex .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#blgxhrurex .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#blgxhrurex .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#blgxhrurex .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#blgxhrurex .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#blgxhrurex .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#blgxhrurex .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#blgxhrurex .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#blgxhrurex .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#blgxhrurex .gt_left {
  text-align: left;
}</p>

<p>#blgxhrurex .gt_center {
  text-align: center;
}</p>

<p>#blgxhrurex .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#blgxhrurex .gt_font_normal {
  font-weight: normal;
}</p>

<p>#blgxhrurex .gt_font_bold {
  font-weight: bold;
}</p>

<p>#blgxhrurex .gt_font_italic {
  font-style: italic;
}</p>

<p>#blgxhrurex .gt_super {
  font-size: 65%;
}</p>

<p>#blgxhrurex .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">lower_coverage_limit</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">upper_coverage_limit</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">priors</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_left">Frequentist</td>
<td class="gt_row gt_right">65.95</td>
<td class="gt_row gt_right">68.25</td>
<td class="gt_row gt_left">non_informative (implied)</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_left">Bayesian</td>
<td class="gt_row gt_right">65.76</td>
<td class="gt_row gt_right">68.45</td>
<td class="gt_row gt_left">non-informative</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve-->
These are quite close! The Bayesian version does remain bit wider. Perhaps with more iterations of MCMC or with slightly less vague priors, the Bayesian version would creep tighter until they converge.</p>

<p>Plotting the upper and lower tolerance limits from the Bayesian version we see that the distribution (upper and lower bounds) are not normal.</p>

<pre><code class="language-r">w_post_tbl %&gt;%
  mutate(upper_95 = qnorm(p = .95, mean = mu, sd = sigma), 
         lower_95 = qnorm(p = .05, mean = mu, sd = sigma),
         id = as_factor(&quot;posterior&quot;)) %&gt;%
  sample_n(size = 10000) %&gt;%
  pivot_longer(cols = c(upper_95, lower_95), names_to = &quot;quantile&quot;, values_to = &quot;value&quot;) %&gt;%
  mutate(quantile = as_factor(quantile)) %&gt;%
  ggplot(aes(x = value, y = id)) +
  geom_jitter(aes(color = quantile), width = .001, height = .1, size = .3, alpha = .05) +
  stat_halfeye(aes(fill = quantile),  alpha = .7, position = position_nudge(y = .2)) +
  scale_color_manual(values = wes_palette(&quot;Moonrise2&quot;)) +
  scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) +
#  scale_color_manual(values = c(&quot;purple&quot;, &quot;limegreen&quot;)) +
#  scale_fill_manual(values = c(&quot;purple&quot;, &quot;limegreen&quot;)) +
  labs(
      x = &quot;&quot;,
      y = &quot;&quot;,
      title = &quot;Distribution of Calculated Upper and Lower Tolerance Limits&quot;,
      subtitle = &quot;Calculated using Bayesian Method&quot;,
      caption = &quot;10,000 Predictions Sampled from Posterior (400,000 total)&quot;
    ) +
  theme(legend.title = element_blank(),
        legend.position = &quot;bottom&quot;) 
</code></pre>

<p><img src="/post/2021-06-22-exploring-frequentist-and-bayesian-tolerance-intervals_files/figure-html/unnamed-chunk-15-1.png" width="100%" height="500px" />
But the upper and lower bounds come in pairs.  Plotting the pairs</p>

<pre><code class="language-r">set.seed(2345)

w_post_tbl %&gt;%
  mutate(upper_95 = qnorm(p = .95, mean = mu, sd = sigma), 
         lower_95 = qnorm(p = .05, mean = mu, sd = sigma)) %&gt;%
  sample_n(10000) %&gt;%
  ggplot(aes(y = lower_95, x = upper_95)) +
  geom_point(alpha = .1, color = &quot;#2c3e50&quot;) +
  geom_hline(yintercept = bt_lower, linetype = 2) +
  geom_vline(xintercept = bt_upper, linetype = 2) +
  theme_minimal() %&gt;%
  labs(
      x = &quot;Predicted upper tolerance bound&quot;,
      y = &quot;Predicted lower tolerance bound&quot;,
      title = &quot;Implied Upper and Lower 95% Tolerance Limits&quot;,
      subtitle = &quot;Based on Credible Posterior Draws&quot;,
      caption = &quot;10,000 Predictions Sampled from Posterior (400,000 total)&quot;
    ) 
</code></pre>

<p><img src="/post/2021-06-22-exploring-frequentist-and-bayesian-tolerance-intervals_files/figure-html/unnamed-chunk-16-1.png" width="100%" height="500px" /></p>

<p>Now we can calculate the number of tolerance bounds that are both:</p>

<ul>
<li>Above (within) the lower 95% tolerance bound for 90% coverage</li>
<li>Below (within) the upper 95% tolerance bound for 90% coverage</li>
</ul>

<p>This number should be less than 500 for a 5% or less false positive rate, since this is a subset of 10,000 draws from the full posterior (which wouldn&rsquo;t display well).</p>

<pre><code class="language-r">set.seed(2345)

w_post_tbl %&gt;%
  mutate(upper_95 = qnorm(p = .95, mean = mu, sd = sigma), 
         lower_95 = qnorm(p = .05, mean = mu, sd = sigma)) %&gt;%
  sample_n(10000) %&gt;% 
  filter(lower_95 &gt; bt_lower,
         upper_95 &lt; bt_upper) %&gt;%
  gt_preview()
</code></pre>

<p><!--html_preserve--><div id="mrrkjpguhd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, &lsquo;Segoe UI&rsquo;, Roboto, Oxygen, Ubuntu, Cantarell, &lsquo;Helvetica Neue&rsquo;, &lsquo;Fira Sans&rsquo;, &lsquo;Droid Sans&rsquo;, Arial, sans-serif;
}</p>

<p>#mrrkjpguhd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}</p>

<p>#mrrkjpguhd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}</p>

<p>#mrrkjpguhd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}</p>

<p>#mrrkjpguhd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}</p>

<p>#mrrkjpguhd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}</p>

<p>#mrrkjpguhd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}</p>

<p>#mrrkjpguhd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}</p>

<p>#mrrkjpguhd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#mrrkjpguhd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}</p>

<p>#mrrkjpguhd .gt_from_md &gt; :first-child {
  margin-top: 0;
}</p>

<p>#mrrkjpguhd .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}</p>

<p>#mrrkjpguhd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}</p>

<p>#mrrkjpguhd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}</p>

<p>#mrrkjpguhd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#mrrkjpguhd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}</p>

<p>#mrrkjpguhd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}</p>

<p>#mrrkjpguhd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}</p>

<p>#mrrkjpguhd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}</p>

<p>#mrrkjpguhd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}</p>

<p>#mrrkjpguhd .gt_left {
  text-align: left;
}</p>

<p>#mrrkjpguhd .gt_center {
  text-align: center;
}</p>

<p>#mrrkjpguhd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}</p>

<p>#mrrkjpguhd .gt_font_normal {
  font-weight: normal;
}</p>

<p>#mrrkjpguhd .gt_font_bold {
  font-weight: bold;
}</p>

<p>#mrrkjpguhd .gt_font_italic {
  font-style: italic;
}</p>

<p>#mrrkjpguhd .gt_super {
  font-size: 65%;
}</p>

<p>#mrrkjpguhd .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table"></p>

<p><thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mu</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sigma</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">upper_95</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">lower_95</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">0.6734567</td>
<td class="gt_row gt_right">0.005124883</td>
<td class="gt_row gt_right">0.6818864</td>
<td class="gt_row gt_right">0.6650271</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">0.6705619</td>
<td class="gt_row gt_right">0.004108660</td>
<td class="gt_row gt_right">0.6773200</td>
<td class="gt_row gt_right">0.6638037</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">0.6704661</td>
<td class="gt_row gt_right">0.005681679</td>
<td class="gt_row gt_right">0.6798116</td>
<td class="gt_row gt_right">0.6611206</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">0.6709579</td>
<td class="gt_row gt_right">0.003404294</td>
<td class="gt_row gt_right">0.6765575</td>
<td class="gt_row gt_right">0.6653584</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">0.6706663</td>
<td class="gt_row gt_right">0.004703547</td>
<td class="gt_row gt_right">0.6784029</td>
<td class="gt_row gt_right">0.6629296</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..9541</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">9542</td>
<td class="gt_row gt_right">0.6713993</td>
<td class="gt_row gt_right">0.004295096</td>
<td class="gt_row gt_right">0.6784641</td>
<td class="gt_row gt_right">0.6643345</td></tr>
  </tbody></p>

<p></table>
</div><!--/html_preserve-->
9,517 rows means 483 false positives - this is correct coverage for the Bayesian interval.</p>

<p>If you&rsquo;ve made it this far, thank you for your attention.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:Stoudt-S-Pintar">Stoudt S, Pintar A, Possolo A (2021) Coverage Intervals. J Res Natl Inst Stan 126:126004. <a href="https://doi.org/10.6028/jres.126.004">https://doi.org/10.6028/jres.126.004</a>.  <a class="footnote-return" href="#fnref:Stoudt-S-Pintar"><sup>[return]</sup></a></li>
</ol>
</div>

  

  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/post/test-post/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/post/test-post/">test_post</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>




</div>

</div>
</div>
<script src="/js/ui.js"></script>
<script src="/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'Your Google Analytics tracking ID', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="/js/math-code.js"></script>
  <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

