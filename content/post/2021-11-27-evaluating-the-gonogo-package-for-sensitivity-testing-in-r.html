---
title: Durability Testing of Stents Using Sensitivity-Based Methods in R
author: Riley
date: '2021-11-27'
categories:
  - R
tags:
  - Sensitivity Testing
slug: evaluating-the-gonogo-package-for-sensitivity-testing-in-r
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>The current industry protocol for durability testing of vascular stents and frames involves testing many implants simultaneously at a range of different stimulus magnitudes (typically strain or stress). The test levels are spread out like a grid across the stimulus range of interest. Each implant is tested to failure or run-out at its specified level and a model is fit to the data using methods similar to those described in Meeker and Escobar.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> An example of a completed durability test of this type is shown below.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Of interest to the designer is the distribution of stimulus levels that would be expected to cause a failure at a specified cycle count like 400 million.</p>
<p><img src="/post/2021-11-27-evaluating-the-gonogo-package-for-sensitivity-testing-in-r_files/sn_1.png" style="width:100.0%" /></p>
<p>This methodology works well if you have a large budget and is accepted by FDA. However, blanketing the parameter space with enough samples to fit a robust model can be very costly and requires enough lab equipment to do many tests in parallel. I recently learned that there is another way that has the potential to significantly reduce test burden and allows for some unique advantages. I will attempt to describe it below.</p>
<p>Sensitivity testing represents a different paradigm in which samples are tested sequentially rather than in parallel. In such testing, the outcome of the first test informs the stimulus level of the second test and so on. When an implant fails at a given stimulus, the next part is tested at a lower level. When it passes, the stimulus on the next is increased. In this way, the latent distribution of part strength is converged upon with each additional test providing improved precision.</p>
<p>The key questions that must be answered to execute a sequential sensitivity test:</p>
<blockquote>
<ul>
<li><strong>“How to specify the test levels for subsequent runs in a principled and efficient way?”</strong></li>
<li><strong>“How to estimate the underlying failure strength distribution when the threshold for failure is not directly assessed on each run?”</strong></li>
</ul>
</blockquote>
<p>Neyer was the first to present a D-Optimal answer to the first question.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> Implementation of the algorithm for determining sequential levels that minimize the test burden and converge on the true underlying strength distribution quickly is not trivial and historically has remained unavailable outside of pricey commercial software.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> Fortunately, generous and diligent researchers have recently created an open source tool in R called “gonogo” which can execute sequential testing according to the D-optimal Neyer algorithm (or its improved direct descendants).<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<p>In the remainder of this post I will show how to use gonogo to determine the underlying strength distribution of hypothetical vascular implant and visualize uncertainty about the estimate.</p>
<ul>
<li><a href="#load-libraries">Load Libraries</a></li>
<li><a href="#accessing-gonogo-functions">Accessing gonogo Functions</a></li>
<li><a href="#simulating-a-sequential-sensitivity-experiment">Simulating A Sequential Sensitivity Experiment</a>
<ul>
<li><a href="#simulate-the-strength-of-each-part">Simulate the Strength of Each Part</a></li>
<li><a href="#see-test-levels-and-input-test-results">See Test Levels and Input Test Results</a></li>
</ul></li>
<li><a href="#confidence,-reliability,-and-visualization">Confidence, Reliability, and Visualization</a>
<ul>
<li><a href="#extract-a-tibble-of-2-sided,-pointwise-confidence-limits-about-all-quantiles">Extract a tibble of 2-sided, pointwise confidence limits about all quantiles</a></li>
<li><a href="#extract-a-point-estimate-for-the-lower-2-sided-confidence-limit-for-the-.10-quantile.">Extract a point estimate for the lower 2-sided confidence limit for the .10 quantile.</a></li>
<li><a href="#plot-cdf">Plot CDF</a></li>
<li><a href="#normal-probability-plot">Normal Probability Plot</a></li>
</ul></li>
<li><a href="#conclusion-and-thanks">Conclusion and Thanks</a></li>
<li><a href="#session-info">Session Info</a></li>
</ul>
<div id="load-libraries" class="section level1">
<h1>Load Libraries</h1>
<pre class="r"><code>library(tidyverse)
library(gt)
library(plotly)
library(ggrepel)
library(here)
library(gonogo)
library(ggalt)</code></pre>
</div>
<div id="accessing-gonogo-functions" class="section level1">
<h1>Accessing gonogo Functions</h1>
<p>The functions in gonogo can be accessed in 2 ways:</p>
<blockquote>
<ul>
<li>Install and load the gonogo package using the instructions listed <a href="https://rdrr.io/github/joncutting/gonogo/f/README.md">HERE</a></li>
<li>Download and source the gonogo script from Jeff Wu’s site <a href="https://www2.isye.gatech.edu/~jeffwu/sensitivitytesting/">HERE</a></li>
</ul>
</blockquote>
<p>I will be using the code sourced from Jeff’s site as the functions are more readily editable.</p>
<pre class="r"><code>source(here(&quot;gonogoRiley.R&quot;))</code></pre>
</div>
<div id="simulating-a-sequential-sensitivity-experiment" class="section level1">
<h1>Simulating A Sequential Sensitivity Experiment</h1>
<p>There are some nice built-in simulation features in gonogo using the gonogoSim function. For our walkthrough though we’ll simulate the data manually to have better visibility of what’s happening under the hood.</p>
<p>Suppose we have a part budget of n=25 stents from manufacturing and our goal is to estimate the underlying distribution of stress amplitude that causes fatigue fracture. First, let’s simulate the failure strength of the 25 parts using a known distribution (which is only available in the simulation). We’ll assume failure stress amplitude for these parts is normally distributed with a mean of 600 MPa and standard deviation of 13 MPa.</p>
<div id="simulate-the-strength-of-each-part" class="section level2">
<h2>Simulate the Strength of Each Part</h2>
<pre class="r"><code>set.seed(805)
stent_strength_tbl &lt;- tibble(part_strength_mpa = rnorm(n = 25, mean = 600, sd = 13))

stent_strength_tbl %&gt;%
  gt_preview()</code></pre>
<div id="rafodmysgk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rafodmysgk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rafodmysgk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rafodmysgk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rafodmysgk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rafodmysgk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rafodmysgk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rafodmysgk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rafodmysgk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rafodmysgk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rafodmysgk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rafodmysgk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rafodmysgk .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rafodmysgk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rafodmysgk .gt_from_md > :first-child {
  margin-top: 0;
}

#rafodmysgk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rafodmysgk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rafodmysgk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#rafodmysgk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rafodmysgk .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#rafodmysgk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rafodmysgk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rafodmysgk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rafodmysgk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rafodmysgk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rafodmysgk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#rafodmysgk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rafodmysgk .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#rafodmysgk .gt_left {
  text-align: left;
}

#rafodmysgk .gt_center {
  text-align: center;
}

#rafodmysgk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rafodmysgk .gt_font_normal {
  font-weight: normal;
}

#rafodmysgk .gt_font_bold {
  font-weight: bold;
}

#rafodmysgk .gt_font_italic {
  font-style: italic;
}

#rafodmysgk .gt_super {
  font-size: 65%;
}

#rafodmysgk .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">part_strength_mpa</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">602.0110</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">585.2761</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">603.3943</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">569.8526</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">601.5328</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..24</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">25</td>
<td class="gt_row gt_right">600.9657</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="see-test-levels-and-input-test-results" class="section level2">
<h2>See Test Levels and Input Test Results</h2>
<p>The gonogo() function will initiate the test plan for sequential testing that prescribes test levels based on the outcome of each run. This operation happens in the console as shown in the screenshot below.</p>
<p><img src="/post/2021-11-27-evaluating-the-gonogo-package-for-sensitivity-testing-in-r_files/sn_console.png" style="width:100.0%" /></p>
<p>We’ll use the Neyer option by setting the “test” argument equal to 2. One key feature of sequential testing is that high and low initial guesses for the mean must be provided at the onset of testing along with an initial guess for the standard deviation. These guesses help set the scale. We’ll provide vague guesses that would be reasonable given our domain knowledge of cobalt-based alloys and their fatigue properties.</p>
<p>If we were really running the test on physical parts we’d want to set up a test at the prescribed stimulus level, then report the result to the console by inputing 2 numbers: the level you actually ran the test at (should be the same as what was recommended) and the outcome (1 for failure or 0 for survival) separated by a single space. After the results from the first test are entered, the recommended level of the next test is presented. When all runs are complete, the results are stored in the assigned object.</p>
<pre class="r"><code># z &lt;- gonogo(mlo = 500, mhi = 700, sg = 10, test = 2, reso = 1) #input results in console</code></pre>
<p>The resulting object z is a list that has a lot of information. The following code will pull the run history and clean it up nicely with tools and formatting from gt package.</p>
<pre class="r"><code>z$d0 %&gt;%
  gt() %&gt;%
  cols_align(&quot;center&quot;) %&gt;%
  opt_row_striping(row_striping = TRUE) %&gt;%
  tab_header(
    title = &quot;Run History of Sensitivity Test of n=25 Stents&quot;,
    subtitle = &quot;X and EX are Stimulus Levels, Y = Outcome (1 = part failed, 0 = part survived)&quot;
  ) %&gt;%
  cols_width(everything() ~ px(100)) %&gt;%
  tab_style(
    style = list(
      cell_text(weight = &quot;bold&quot;)
    ),
    locations = cells_column_labels(columns = everything())
  )</code></pre>
<div id="dfbppuzvmd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dfbppuzvmd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dfbppuzvmd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dfbppuzvmd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dfbppuzvmd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dfbppuzvmd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dfbppuzvmd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dfbppuzvmd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dfbppuzvmd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dfbppuzvmd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dfbppuzvmd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dfbppuzvmd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dfbppuzvmd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dfbppuzvmd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dfbppuzvmd .gt_from_md > :first-child {
  margin-top: 0;
}

#dfbppuzvmd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dfbppuzvmd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dfbppuzvmd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#dfbppuzvmd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dfbppuzvmd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#dfbppuzvmd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dfbppuzvmd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dfbppuzvmd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dfbppuzvmd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dfbppuzvmd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dfbppuzvmd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#dfbppuzvmd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dfbppuzvmd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#dfbppuzvmd .gt_left {
  text-align: left;
}

#dfbppuzvmd .gt_center {
  text-align: center;
}

#dfbppuzvmd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dfbppuzvmd .gt_font_normal {
  font-weight: normal;
}

#dfbppuzvmd .gt_font_bold {
  font-weight: bold;
}

#dfbppuzvmd .gt_font_italic {
  font-style: italic;
}

#dfbppuzvmd .gt_super {
  font-size: 65%;
}

#dfbppuzvmd .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 0px">
  <colgroup>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
    <col style="width:100px;"/>
  </colgroup>
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style>Run History of Sensitivity Test of n=25 Stents</th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>X and EX are Stimulus Levels, Y = Outcome (1 = part failed, 0 = part survived)</th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">X</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">Y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">COUNT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">RX</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">EX</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">TX</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;">ID</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_center">600</td>
<td class="gt_row gt_center">0</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">600</td>
<td class="gt_row gt_center">600.0000</td>
<td class="gt_row gt_center">600</td>
<td class="gt_row gt_center">B0</td></tr>
    <tr><td class="gt_row gt_center gt_striped">650</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">650</td>
<td class="gt_row gt_center gt_striped">650.0000</td>
<td class="gt_row gt_center gt_striped">650</td>
<td class="gt_row gt_center gt_striped">B1</td></tr>
    <tr><td class="gt_row gt_center">625</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">625</td>
<td class="gt_row gt_center">625.0000</td>
<td class="gt_row gt_center">625</td>
<td class="gt_row gt_center">B3</td></tr>
    <tr><td class="gt_row gt_center gt_striped">612</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">612</td>
<td class="gt_row gt_center gt_striped">612.5000</td>
<td class="gt_row gt_center gt_striped">612</td>
<td class="gt_row gt_center gt_striped">B3</td></tr>
    <tr><td class="gt_row gt_center">606</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">606</td>
<td class="gt_row gt_center">606.0000</td>
<td class="gt_row gt_center">606</td>
<td class="gt_row gt_center">B3</td></tr>
    <tr><td class="gt_row gt_center gt_striped">590</td>
<td class="gt_row gt_center gt_striped">0</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">590</td>
<td class="gt_row gt_center gt_striped">589.7220</td>
<td class="gt_row gt_center gt_striped">590</td>
<td class="gt_row gt_center gt_striped">B4</td></tr>
    <tr><td class="gt_row gt_center">593</td>
<td class="gt_row gt_center">0</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">593</td>
<td class="gt_row gt_center">592.5733</td>
<td class="gt_row gt_center">593</td>
<td class="gt_row gt_center">B4</td></tr>
    <tr><td class="gt_row gt_center gt_striped">611</td>
<td class="gt_row gt_center gt_striped">0</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">611</td>
<td class="gt_row gt_center gt_striped">610.7146</td>
<td class="gt_row gt_center gt_striped">611</td>
<td class="gt_row gt_center gt_striped">B4</td></tr>
    <tr><td class="gt_row gt_center">617</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">617</td>
<td class="gt_row gt_center">616.8731</td>
<td class="gt_row gt_center">617</td>
<td class="gt_row gt_center">II1</td></tr>
    <tr><td class="gt_row gt_center gt_striped">599</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">599</td>
<td class="gt_row gt_center gt_striped">599.4648</td>
<td class="gt_row gt_center gt_striped">599</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">590</td>
<td class="gt_row gt_center">0</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">590</td>
<td class="gt_row gt_center">590.4793</td>
<td class="gt_row gt_center">590</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">616</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">616</td>
<td class="gt_row gt_center gt_striped">615.7384</td>
<td class="gt_row gt_center gt_striped">616</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">593</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">593</td>
<td class="gt_row gt_center">592.9877</td>
<td class="gt_row gt_center">593</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">584</td>
<td class="gt_row gt_center gt_striped">0</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">584</td>
<td class="gt_row gt_center gt_striped">583.6982</td>
<td class="gt_row gt_center gt_striped">584</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">585</td>
<td class="gt_row gt_center">0</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">585</td>
<td class="gt_row gt_center">585.3147</td>
<td class="gt_row gt_center">585</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">615</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">615</td>
<td class="gt_row gt_center gt_striped">615.2118</td>
<td class="gt_row gt_center gt_striped">615</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">587</td>
<td class="gt_row gt_center">0</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">587</td>
<td class="gt_row gt_center">587.4391</td>
<td class="gt_row gt_center">587</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">613</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">613</td>
<td class="gt_row gt_center gt_striped">613.3351</td>
<td class="gt_row gt_center gt_striped">613</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">612</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">612</td>
<td class="gt_row gt_center">612.3336</td>
<td class="gt_row gt_center">612</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">589</td>
<td class="gt_row gt_center gt_striped">0</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">589</td>
<td class="gt_row gt_center gt_striped">589.3771</td>
<td class="gt_row gt_center gt_striped">589</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">611</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">611</td>
<td class="gt_row gt_center">611.0667</td>
<td class="gt_row gt_center">611</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">590</td>
<td class="gt_row gt_center gt_striped">0</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">590</td>
<td class="gt_row gt_center gt_striped">590.4844</td>
<td class="gt_row gt_center gt_striped">590</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">610</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">610</td>
<td class="gt_row gt_center">610.0713</td>
<td class="gt_row gt_center">610</td>
<td class="gt_row gt_center">II2</td></tr>
    <tr><td class="gt_row gt_center gt_striped">591</td>
<td class="gt_row gt_center gt_striped">0</td>
<td class="gt_row gt_center gt_striped">1</td>
<td class="gt_row gt_center gt_striped">591</td>
<td class="gt_row gt_center gt_striped">591.3679</td>
<td class="gt_row gt_center gt_striped">591</td>
<td class="gt_row gt_center gt_striped">II2</td></tr>
    <tr><td class="gt_row gt_center">609</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">1</td>
<td class="gt_row gt_center">609</td>
<td class="gt_row gt_center">609.2816</td>
<td class="gt_row gt_center">609</td>
<td class="gt_row gt_center">II2</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Gonogo has some really convenient built-in visualization tools. The run history can be plotted using gonogo’s ptest function with argument plt=1.</p>
<pre class="r"><code>ptest(z, plt = 1)</code></pre>
<p><img src="/post/2021-11-27-evaluating-the-gonogo-package-for-sensitivity-testing-in-r_files/figure-html/unnamed-chunk-8-1.png" width="100%" height="500px" /></p>
<pre><code>## NULL</code></pre>
<p>The values we really care about are the estimates of the mean and sd of the latent failure strength distribution. Numerical MLE’s for these parameters can be quickly extracted as follows:</p>
<pre class="r"><code>z$musig</code></pre>
<pre><code>## [1] 600.383131   7.894673</code></pre>
<p><strong>We see that these are quite close to the true parameters of mean = 600 MPa, sd = 13 MPa!</strong> That really impressive for only 25 parts and vague initial guesses.</p>
<p>I like to occasionally look under the hood and see how the outputs are generated. I don’t always understand it but it helps me learn. In this case, the calculations to extract an estimate are pretty simple. gonogo is using a glm with probit link function. The results are replicated here with manual calculations.</p>
<pre class="r"><code>xglm &lt;- glm(Y ~ X, family = binomial(link = probit), data = z$d0)

ab &lt;- as.vector(xglm$coef)
muhat &lt;- -ab[1] / ab[2]
sighat &lt;- 1 / ab[2]

tibble(
  true_parameter = c(600, 13),
  gonogo_estimate = c(muhat, sighat)
) %&gt;%
  mutate(gonogo_estimate = gonogo_estimate %&gt;% round(1)) %&gt;%
  gt()</code></pre>
<div id="zloacqoqqs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zloacqoqqs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zloacqoqqs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zloacqoqqs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zloacqoqqs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zloacqoqqs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zloacqoqqs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zloacqoqqs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zloacqoqqs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zloacqoqqs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zloacqoqqs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zloacqoqqs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zloacqoqqs .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zloacqoqqs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zloacqoqqs .gt_from_md > :first-child {
  margin-top: 0;
}

#zloacqoqqs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zloacqoqqs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zloacqoqqs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#zloacqoqqs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zloacqoqqs .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#zloacqoqqs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zloacqoqqs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zloacqoqqs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zloacqoqqs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zloacqoqqs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zloacqoqqs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#zloacqoqqs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zloacqoqqs .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#zloacqoqqs .gt_left {
  text-align: left;
}

#zloacqoqqs .gt_center {
  text-align: center;
}

#zloacqoqqs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zloacqoqqs .gt_font_normal {
  font-weight: normal;
}

#zloacqoqqs .gt_font_bold {
  font-weight: bold;
}

#zloacqoqqs .gt_font_italic {
  font-style: italic;
}

#zloacqoqqs .gt_super {
  font-size: 65%;
}

#zloacqoqqs .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">true_parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">gonogo_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">600</td>
<td class="gt_row gt_right">600.4</td></tr>
    <tr><td class="gt_row gt_right">13</td>
<td class="gt_row gt_right">7.9</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div id="confidence-reliability-and-visualization" class="section level1">
<h1>Confidence, Reliability, and Visualization</h1>
<p>We just identified the MLE’s for the latent strength distribution. But anytime we’re working with medical devices we have to be conservative and respect the uncertainty in our methods. We don’t want to use the mean of the distribution to describe a design. Instead, we identify a lower quantile of interest and then put a confidence interval on that to be extra conservative.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> gonogo has some great tools and functions for helping us achieve these goals. I prefer to use the tidyverse framework for my data analysis and visualization so I combine the built in functions from gonogo with some helper functions that I wrote to keep things tidy. I present them here with some description of what they do but not much explanation of how they work. Sorry.</p>
<p>I will note however that gonogo provides options for obtaining multiple forms of confidence intervals: Fisher Matrix, GLM, and Likelihood-Based. For additional information on how it calculates each type, refer to <a href="https://www2.isye.gatech.edu/~jeffwu/sensitivitytesting/gonogo.pdf">THIS DOCUMENTATION</a>. In the tests I ran, GLM and LR based CIs performed almost the same; FM was different. I use GLM below for my purposes.</p>
<p>In the following work, I assume we care about the 95% confidence bound on the .10 quantile. gonogo calculates all intervals as 2-sided, so to get the 95% confidence bound (1-sided) we request the 90% 2-sided limits.</p>
<div id="extract-a-tibble-of-2-sided-pointwise-confidence-limits-about-all-quantiles" class="section level2">
<h2>Extract a tibble of 2-sided, pointwise confidence limits about all quantiles</h2>
<p>This first function takes the output from the gonogo function and calculates 2-sided .90 confidence bounds on the various quantiles. The lims() function is from gonogo.</p>
<pre class="r"><code># helper function

conf_limits_fcn &lt;- function(tbl, conf = .9) {
  conf_limits_tbl_full &lt;- lims(ctyp = 2, dat = tbl, conf = conf, P = seq(from = .01, to = .99, by = .01)) %&gt;%
    as_tibble() %&gt;%
    rename(
      ciq_lower = V1,
      estimate_q = V2,
      ciq_upper = V3,
      ip_lower = V4,
      estimate_p = V5,
      cip_upper = V6
    )
}

rileysim_conf_tbl &lt;- conf_limits_fcn(z$d0)

rileysim_conf_tbl %&gt;%
  gt_preview()</code></pre>
<div id="zqnuibzgwa" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zqnuibzgwa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zqnuibzgwa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zqnuibzgwa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zqnuibzgwa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zqnuibzgwa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqnuibzgwa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zqnuibzgwa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zqnuibzgwa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zqnuibzgwa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zqnuibzgwa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zqnuibzgwa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zqnuibzgwa .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zqnuibzgwa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zqnuibzgwa .gt_from_md > :first-child {
  margin-top: 0;
}

#zqnuibzgwa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zqnuibzgwa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zqnuibzgwa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#zqnuibzgwa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqnuibzgwa .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#zqnuibzgwa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqnuibzgwa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zqnuibzgwa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zqnuibzgwa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqnuibzgwa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zqnuibzgwa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#zqnuibzgwa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zqnuibzgwa .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#zqnuibzgwa .gt_left {
  text-align: left;
}

#zqnuibzgwa .gt_center {
  text-align: center;
}

#zqnuibzgwa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zqnuibzgwa .gt_font_normal {
  font-weight: normal;
}

#zqnuibzgwa .gt_font_bold {
  font-weight: bold;
}

#zqnuibzgwa .gt_font_italic {
  font-style: italic;
}

#zqnuibzgwa .gt_super {
  font-size: 65%;
}

#zqnuibzgwa .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ciq_lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate_q</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ciq_upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ip_lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate_p</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">cip_upper</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">1</td>
<td class="gt_row gt_right">566.0095</td>
<td class="gt_row gt_right">582.0174</td>
<td class="gt_row gt_right">590.1744</td>
<td class="gt_row gt_right">0.000057</td>
<td class="gt_row gt_right">0.01</td>
<td class="gt_row gt_right">0.127107</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">2</td>
<td class="gt_row gt_right">569.7538</td>
<td class="gt_row gt_right">584.1695</td>
<td class="gt_row gt_right">591.6789</td>
<td class="gt_row gt_right">0.000283</td>
<td class="gt_row gt_right">0.02</td>
<td class="gt_row gt_right">0.165152</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">3</td>
<td class="gt_row gt_right">572.1145</td>
<td class="gt_row gt_right">585.5349</td>
<td class="gt_row gt_right">592.6478</td>
<td class="gt_row gt_right">0.000714</td>
<td class="gt_row gt_right">0.03</td>
<td class="gt_row gt_right">0.193273</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">4</td>
<td class="gt_row gt_right">573.8819</td>
<td class="gt_row gt_right">586.5620</td>
<td class="gt_row gt_right">593.3851</td>
<td class="gt_row gt_right">0.001369</td>
<td class="gt_row gt_right">0.04</td>
<td class="gt_row gt_right">0.216580</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">5</td>
<td class="gt_row gt_right">575.3128</td>
<td class="gt_row gt_right">587.3975</td>
<td class="gt_row gt_right">593.9914</td>
<td class="gt_row gt_right">0.002260</td>
<td class="gt_row gt_right">0.05</td>
<td class="gt_row gt_right">0.236954</td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..98</td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><td class="gt_row gt_left gt_stub" style="font-family: Courier;">99</td>
<td class="gt_row gt_right">610.9205</td>
<td class="gt_row gt_right">618.7489</td>
<td class="gt_row gt_right">633.9138</td>
<td class="gt_row gt_right">0.884141</td>
<td class="gt_row gt_right">0.99</td>
<td class="gt_row gt_right">0.999923</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="extract-a-point-estimate-for-the-lower-2-sided-confidence-limit-for-the-.10-quantile." class="section level2">
<h2>Extract a point estimate for the lower 2-sided confidence limit for the .10 quantile.</h2>
<p>We present results to FDA using the terminology “confidence and reliability”. By extracting the lower end of the 2-sided 90% confidence band on the .10 quantile, we obtain an estimate of the 95/90 tolerance bound i.e. a bound above which we would expect 90% or more of the population to lie, with 95% confidence. This would be a conservative estimate of the endurance limit for this stent design.</p>
<pre class="r"><code>lower_conf_fcn &lt;- function(tbl, percentile) {
  lower_scalar &lt;- tbl %&gt;%
    mutate(qprobs = qnorm(estimate_p)) %&gt;%
    arrange(qprobs) %&gt;%
    filter(estimate_p == percentile) %&gt;%
    mutate(ciq_lower = ciq_lower %&gt;% round(1)) %&gt;%
    pluck(1)

  lower_qnorm &lt;- tbl %&gt;%
    mutate(qprobs = qnorm(estimate_p)) %&gt;%
    arrange(qprobs) %&gt;%
    filter(estimate_p == percentile) %&gt;%
    pluck(7)

  lower_tbl &lt;- tibble(
    estimate_q = lower_scalar,
    estimate_p = percentile,
    qprobs = lower_qnorm
  )

  return(lower_tbl)
}

lower_conf_fcn(rileysim_conf_tbl, percentile = .1) %&gt;% pluck(1)</code></pre>
<pre><code>## [1] 580.2</code></pre>
</div>
<div id="plot-cdf" class="section level2">
<h2>Plot CDF</h2>
<p>Now some plotting functions to help visualize things. First, we use our confidence limit dataframe from above to construct a cdf of failure strength. With some clever use of geom_label_repel() and str_glue() we can embed our data right onto the plot for easy communication. The estimated endurance limit from our test sequence is 580 MPa.</p>
<pre class="r"><code>plot_cdf_fcn &lt;- function(tbl, percentile = .1, units = &quot;MPa&quot;) {
  tbl %&gt;%
    ggplot(aes(x = ciq_lower, y = estimate_p)) +
    geom_line(size = 1.3) +
    geom_line(aes(x = ciq_upper, y = estimate_p), size = 1.3) +
    geom_line(aes(x = estimate_q, y = estimate_p), linetype = 2) +
    geom_ribbon(aes(xmin = ciq_lower, xmax = ciq_upper), alpha = .1, fill = &quot;purple&quot;) +
    geom_point(data = lower_conf_fcn(tbl, percentile = percentile), aes(estimate_q, estimate_p), color = &quot;purple&quot;, size = 2) +
    geom_label_repel(
      data = lower_conf_fcn(tbl, percentile = percentile),
      aes(estimate_q, estimate_p),
      label = str_glue(&quot;1-sided, 95% Confidence Bound:\n{lower_conf_fcn(rileysim_conf_tbl, percentile = .1) %&gt;% pluck(1)} {units}&quot;),
      fill = &quot;#8bd646ff&quot;,
      color = &quot;black&quot;,
      segment.color = &quot;black&quot;,
      segment.size = .5,
      nudge_y = .13,
      nudge_x = -25
    ) +
    geom_segment(data = tbl %&gt;%
      filter(estimate_p == percentile), aes(x = ciq_lower, xend = ciq_upper, y = estimate_p, yend = estimate_p), linetype = 3) +
    theme_bw() +
    labs(
      x = &quot;Stress (MPa)&quot;,
      y = &quot;Percentile&quot;,
      caption = &quot;Dotted line is estimate of failure strength distribution\nConfidence bands are 2-sided 90% (i.e. 1-sided 95 for lower)&quot;,
      title = &quot;Sensitivity Testing of Stent Durability&quot;,
      subtitle = str_glue(&quot;placeholder&quot;)
    )
}

a &lt;- plot_cdf_fcn(tbl = rileysim_conf_tbl, percentile = .1)

a +
  labs(subtitle = str_glue(&quot;Estimates: Mean = {muhat %&gt;% round(1)} MPa, Sigma = {sighat %&gt;% round(1)} MPa&quot;))</code></pre>
<p><img src="/post/2021-11-27-evaluating-the-gonogo-package-for-sensitivity-testing-in-r_files/figure-html/unnamed-chunk-13-1.png" width="100%" height="500px" /></p>
</div>
<div id="normal-probability-plot" class="section level2">
<h2>Normal Probability Plot</h2>
<p>Engineers in my industry have an unhealthy obsession to normal probability plots. Personally I don’t like them, but Minitab presents them by default and engineers in my industry will look for data in this format. As part of this project I taught myself how to convert distributional data from a CFD into a normal probability plot. I show the helper function here and the result.</p>
<pre class="r"><code>norm_probability_plt_fcn &lt;- function(tbl, percentile, units = &quot;MPa&quot;) {
  conf_tbl &lt;- tbl %&gt;%
    mutate(qprobs = qnorm(estimate_p)) %&gt;%
    arrange(qprobs)

  probs_of_interest &lt;- c(0.01, 0.05, seq(0.1, 0.9, by = 0.1), 0.95, 0.99)

  probs_of_interest_tbl &lt;- conf_tbl %&gt;%
    filter(estimate_p %in% probs_of_interest)

  conf_tbl %&gt;%
    ggplot() +
    geom_line(aes(x = ciq_lower, y = qprobs), size = 1.3) +
    geom_line(aes(x = ciq_upper, y = qprobs), size = 1.3) +
    geom_line(aes(x = estimate_q, y = qprobs), linetype = 2) +
    geom_ribbon(aes(xmin = ciq_lower, xmax = ciq_upper, y = qprobs), alpha = .1, fill = &quot;purple&quot;) +
    geom_point(data = lower_conf_fcn(tbl, percentile = percentile), aes(estimate_q, qprobs), color = &quot;purple&quot;, size = 2) +
    geom_label_repel(
      data = lower_conf_fcn(tbl, percentile = percentile),
      aes(estimate_q, qprobs),
      label = str_glue(&quot;1-sided, 95% Confidence Bound:\n{lower_conf_fcn(rileysim_conf_tbl, percentile = .1) %&gt;% pluck(1)} {units}&quot;),
      fill = &quot;#8bd646ff&quot;,
      color = &quot;black&quot;,
      segment.color = &quot;black&quot;,
      segment.size = .5,
      nudge_y = 1,
      nudge_x = -20
    ) +
    geom_segment(data = conf_tbl %&gt;%
      filter(estimate_p == percentile), aes(x = ciq_lower, xend = ciq_upper, y = qprobs, yend = qprobs), linetype = 3) +
    scale_y_continuous(limits = range(conf_tbl$qprobs), breaks = probs_of_interest_tbl$qprobs, labels = 100 * probs_of_interest_tbl$estimate_p) +
    theme_bw() +
    labs(
      x = &quot;Stress (MPa)&quot;,
      y = &quot;Percentile&quot;,
      caption = &quot;Dotted line is estimate of failure strength distribution\nConfidence bands are 2-sided 90%&quot;,
      title = &quot;Sensitivity Testing of Stent Durability&quot;,
      subtitle = str_glue(&quot;TBD_2&quot;)
    )
}

b &lt;- norm_probability_plt_fcn(rileysim_conf_tbl, percentile = .1)

b +
  labs(subtitle = str_glue(&quot;Estimates: Mean = {muhat %&gt;% round(1)} MPa, Sigma = {sighat %&gt;% round(1)} MPa&quot;))</code></pre>
<p><img src="/post/2021-11-27-evaluating-the-gonogo-package-for-sensitivity-testing-in-r_files/figure-html/unnamed-chunk-14-1.png" width="100%" height="500px" /></p>
</div>
</div>
<div id="conclusion-and-thanks" class="section level1">
<h1>Conclusion and Thanks</h1>
<p>There you have it! A way to determine failure strength distributions using principled, sequential testing techniques guided by gonogo. If you’ve made it this far I really appreciate your attention. I would like to thank <strong>Paul Roediger</strong> for producing this amazing toolkit and for graciously offering your time to help me troubleshoot and work through some challenges on this project earlier this year. I’ll always be grateful to the open source community for making these things possible.</p>
</div>
<div id="session-info" class="section level1">
<h1>Session Info</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.0.3 (2020-10-10)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 18363)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggalt_0.4.0     gonogo_0.1.0    here_1.0.0      ggrepel_0.8.2  
##  [5] plotly_4.9.2.1  gt_0.2.2        forcats_0.5.0   stringr_1.4.0  
##  [9] dplyr_1.0.7     purrr_0.3.4     readr_1.4.0     tidyr_1.1.3    
## [13] tibble_3.1.4    ggplot2_3.3.5   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##  [1] fs_1.5.0           lubridate_1.7.9.2  ash_1.0-15         RColorBrewer_1.1-2
##  [5] httr_1.4.2         rprojroot_2.0.2    tools_4.0.3        backports_1.2.0   
##  [9] bslib_0.3.0        utf8_1.2.2         R6_2.5.1           KernSmooth_2.23-18
## [13] DBI_1.1.0          lazyeval_0.2.2     colorspace_2.0-2   withr_2.4.2       
## [17] tidyselect_1.1.1   compiler_4.0.3     extrafontdb_1.0    cli_3.0.1         
## [21] rvest_0.3.6        xml2_1.3.2         labeling_0.4.2     bookdown_0.21     
## [25] sass_0.4.0         scales_1.1.1       checkmate_2.0.0    proj4_1.0-10      
## [29] digest_0.6.28      rmarkdown_2.11     pkgconfig_2.0.3    htmltools_0.5.2   
## [33] extrafont_0.17     dbplyr_2.0.0       fastmap_1.1.0      highr_0.9         
## [37] maps_3.3.0         htmlwidgets_1.5.4  rlang_0.4.11       readxl_1.3.1      
## [41] rstudioapi_0.13    jquerylib_0.1.4    generics_0.1.0     farver_2.1.0      
## [45] jsonlite_1.7.2     magrittr_2.0.1     Rcpp_1.0.7         munsell_0.5.0     
## [49] fansi_0.5.0        lifecycle_1.0.1    stringi_1.7.4      yaml_2.2.1        
## [53] MASS_7.3-53        grid_4.0.3         crayon_1.4.1       haven_2.3.1       
## [57] hms_0.5.3          knitr_1.34         pillar_1.6.2       reprex_0.3.0      
## [61] glue_1.4.2         evaluate_0.14      blogdown_0.15      data.table_1.14.0 
## [65] modelr_0.1.8       vctrs_0.3.8        Rttf2pt1_1.3.8     cellranger_1.1.0  
## [69] gtable_0.3.0       assertthat_0.2.1   xfun_0.26          broom_0.7.8       
## [73] viridisLite_0.4.0  ellipsis_0.3.2</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://www.wiley.com/en-us/Statistical+Methods+for+Reliability+Data%2C+2nd+Edition-p-9781118115459" class="uri">https://www.wiley.com/en-us/Statistical+Methods+for+Reliability+Data%2C+2nd+Edition-p-9781118115459</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="https://www2.lbl.gov/ritchie/Library/PDF/2020%20Cao-Nitinol%20HCF.pdf" class="uri">https://www2.lbl.gov/ritchie/Library/PDF/2020%20Cao-Nitinol%20HCF.pdf</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><a href="https://en.wikipedia.org/wiki/Neyer_d-optimal_test" class="uri">https://en.wikipedia.org/wiki/Neyer_d-optimal_test</a><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Neyer provided a commercial software called Sentest to facilitate practitioners who wanted to use D-optimal methods without developing their own software<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p><a href="https://arxiv.org/ftp/arxiv/papers/2011/2011.11177.pdf" class="uri">https://arxiv.org/ftp/arxiv/papers/2011/2011.11177.pdf</a><a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Since we only care about a 1-sided confidence interval, the 1-sided confidence bound on a specified quantile becomes analogous to a tolerance interval<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
